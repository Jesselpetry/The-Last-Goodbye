import Link from "next/link";
import Letter from "@/components/Letter";
import { Lock } from "lucide-react";
import { getFriendBySlug } from "@/app/actions/tracking";

export const dynamic = 'force-dynamic';

export default async function Home() {
  const friend = await getFriendBySlug('home');

  // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Archive ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ 3 ‡∏õ‡∏µ (‡πÄ‡∏à‡∏™‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
  const archiveContent = `1,095 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏ó‡∏∏‡∏°‡πÄ‡∏ó‡∏û‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏≤‡∏£... ‡πÄ‡∏ß‡∏•‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ‡πÑ‡∏ß‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏Å‡∏´‡∏Å‡πÄ‡∏•‡∏¢‡πÄ‡∏ô‡∏≠‡∏∞

‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡πá‡∏Å ‡∏°.4 ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏Å‡πâ‡∏≤‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏£‡∏±‡πâ‡∏ß‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏™‡∏π‡πà‡πÄ‡∏î‡πá‡∏Å ‡∏°.6 ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏ö‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 31 ‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏° 2026 ‡∏ô‡∏µ‡πâ ‡∏ï‡∏•‡∏≠‡∏î 3 ‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏Ñ‡∏ï‡∏£‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏π‡πÄ‡∏•‡∏¢

‡∏Å‡∏π‡πÑ‡∏î‡πâ‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏Å‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏Ç‡πà‡∏á‡∏ö‡∏≤‡∏™‡∏à‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏ä‡∏°‡∏õ‡πå ‡∏ó‡∏≥‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå PTK Connext ‡∏£‡πà‡∏ß‡∏°‡∏•‡∏∏‡∏¢ D-Youth ‡πÄ‡∏õ‡∏¥‡∏î‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à '‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà Studio' ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏∏‡∏¢‡∏™‡∏≤‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏≠‡∏¢‡πà‡∏≤‡∏á Bangmod Hackathon, Creative AI Camp ‡πÅ‡∏•‡∏∞ JWC ‡πÅ‡∏ñ‡∏°‡∏¢‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ODOS ‡πÑ‡∏õ‡πÑ‡∏Å‡∏•‡∏ñ‡∏∂‡∏á Seattle ‡∏≠‡∏µ‡∏Å ‡∏ó‡∏∏‡∏Å‡πÜ ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå ‡∏ó‡∏∏‡∏Å‡πÜ ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á ‡πÅ‡∏•‡∏∞‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡∏°‡∏±‡∏ô‡∏´‡∏•‡πà‡∏≠‡∏´‡∏•‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏Å‡∏π‡πÄ‡∏õ‡πá‡∏ô '‡πÄ‡∏à‡∏™' ‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ

‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏¢‡∏ã‡∏±‡∏û‡∏û‡∏≠‡∏£‡πå‡∏ï ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏° ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏°‡πâ‡πÅ‡∏ï‡πà‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ô‡∏±‡πà‡∏á‡∏õ‡∏±‡πà‡∏ô‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ô ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏≠ '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥' ‡∏ó‡∏µ‡πà‡∏Å‡∏π‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏•‡∏∑‡∏°

‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà The Last Goodbye... ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÅ‡∏¢‡∏Å‡∏¢‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏ô‡∏∞ ü§ç`;

  // ‡πÄ‡∏à‡∏™‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏≠‡∏≤‡∏£‡∏π‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏£‡∏ß‡∏°‡πÜ (‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏π‡∏õ‡πÅ‡∏Å‡πä‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô ‡∏£‡∏π‡∏õ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô) ‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå public/ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
  const archiveImages = [
    "/ptk-memory-1.jpg",
    "/ptk-memory-1.jpg",
    "/ptk-memory-1.jpg",
  ];

  const name = friend ? friend.name : "‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ß‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤";
  const content = friend ? (friend.content || archiveContent) : archiveContent;

  let imageUrls = archiveImages;
  if (friend) {
    if (friend.image_urls && friend.image_urls.length > 0) {
      imageUrls = friend.image_urls;
    } else if (friend.image_url) {
      imageUrls = [friend.image_url];
    }
  }

  const timestamp = friend ? (friend.unlock_date || friend.updated_at || friend.created_at) : "2026-03-31T00:00:00Z";

  return (
    <div className="relative min-h-screen">
      
      {/* ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Letter Component ‡πÉ‡∏´‡πâ‡∏ü‡∏µ‡∏•‡∏•‡∏¥‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ */}
      <Letter
        friendId={friend?.id}
        name={name}
        content={content}
        imageUrls={imageUrls.length > 0 ? imageUrls : null}
        spotifyUrl={friend?.spotify_url}
        bgmUrl={friend?.bgm_url}
        timestamp={timestamp} // ‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏ô‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏¥‡∏°‡∏°‡∏¥‡∏Ñ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏ô unlock
      />
      
    </div>
  );
}
